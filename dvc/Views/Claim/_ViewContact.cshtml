
@using Microsoft.Ajax.Utilities
@using VanWagenen.Dvc.Repository.Models
@using VanWagenen.Dvc.Web.Helpers


@model VanWagenen.Dvc.Web.ViewModels.UpdateClaimViewModel
    
<script type="text/javascript">
    $(document).ready(function() {
        $('#contacts > tbody  > tr').each(function () {

            var thisOpenClaimsValue = $(this).find('.ContactActive').html().trim();

            if (thisOpenClaimsValue === "No") {
                $(this).closest('tr').addClass("text-gray");
            }
        });
    });
</script>

<div id="view-contact">
    @if (Model.Claim.ClaimContacts != null && Model.Claim.ClaimContacts.Count() > 0)
    {
        <table class="table" id="contacts">
            <thead>
                <tr>
                    <th>Actions</th>
                    <th>@Html.DisplayName("Carrier")</th>
                    <th>@Html.DisplayName("First Name")</th>
                    <th>@Html.DisplayName("Last Name")</th>
                    <th>@Html.DisplayName("Phone")</th>
                    <th>@Html.DisplayName("Extension")</th>
                    <th>@Html.DisplayName("Fax")</th>
                    <th>@Html.DisplayName("Active")</th>
                </tr>
            </thead>

            <tbody>
                @foreach (ClaimContact claimContact in Model.Claim.ClaimContacts.OrderByDescending(cc => cc.Contact.Active))
                {
                    <tr data-id="@claimContact.Contact.Id">
                        <td>
                            @if (Model.CanEditClaim)
                            {
                                <span title="Edit Contact" data-toggle="tooltip">
                                    @Html.ActionLink(" ", "EditClaimContact", "Claim", new { claimId = claimContact.ClaimId, contactId = claimContact.ContactId }, new { @class = "fa fa-pencil-square-o row-button", data_target = "#modal-container", data_toggle = "modal", data_backdrop = "static" })
                                </span>
                                <span title="Disable Contact" data-toggle="tooltip">
                                    @Ajax.ActionLink(" ", "DeleteContact", "Claim", new { contactId = claimContact.ContactId, claimId = claimContact.ClaimId }, new AjaxOptions { HttpMethod = "DELETE", UpdateTargetId = "view-contact", Confirm = "Are you sure you want to delete this contact?" }, new { @class = "fa fa-trash row-button" })
                                </span>
                            }
                        </td>
                        <td>@Html.DisplayFor(modelItem => claimContact.Contact.Carrier)</td>
                        <td>@Html.DisplayFor(modelItem => claimContact.Contact.FirstName)</td>
                        <td>@Html.DisplayFor(modelItem => claimContact.Contact.LastName)</td>
                        <td>@Html.PhoneNumber(claimContact.Contact.PhoneNumber)</td>
                        <td>@Html.DisplayFor(modelItem => claimContact.Contact.PhoneExtension)</td>
                        <td>@Html.PhoneNumber(claimContact.Contact.FaxNumber)</td>
                        <td class="ContactActive">@(claimContact.Contact.Active ? "Yes" : "No")</td>

                    </tr>

                }
            </tbody>
            
        </table>
    }
</div>
